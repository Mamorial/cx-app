<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<script src="../../js/headHtml.js" type="text/javascript" charset="utf-8"></script>
	</head>
	<body>
		<div id="complaint">
			<header class="mui-bar mui-bar-nav">
			    <a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			    <button class="mui-action-back mui-btn mui-btn-blue mui-btn-link mui-btn-nav mui-pull-left">&nbsp;返回</button>
			    <h1 class="mui-title">投诉</h1>
			</header>
			<div class="complaint-content">
				<textarea v-model="complaint_content" placeholder="请输入投诉的内容"></textarea>
				<input type="text" placeholder="请输入您的联系方式" v-model="user_phone" readonly="readonly" />
			</div>
			<div class="mui-button-row complaint-bottom">
				<button class="mui-btn-primary" @click="submitComplaint">提交</button>
			</div>
		</div>
	</body>
</html>
<style type="text/css">
	body, html{
		overflow: hidden;
	}
	.complaint-content{
		width: 90%;
		height: auto;
		margin: 54px auto;
		background: none;
	}
	.complaint-content textarea{
		width: 100%;
		height: 300px;
	}
	.complaint-content input{
		width: 100%;
		height: 40px;
		margin-top: 10px;
		color: #ccc;
	}
	.complaint-bottom button{
		width: 50%;
		margin-top: 10px;
		height: 40px;
	}
</style>
<script type="text/javascript">
	var app = new Vue({
		el: '#complaint',
		data: {
			complaint_content: '',    //投诉内容
			user_phone: '18279132664'       //投诉人联系方式
		},
		mounted: function() {
			
		},
		methods: {
			//提交按钮
			submitComplaint: function() {
				var self = this;
				var param = {
					user: null,
					message: self.complaint_content,
					phone_number: self.user_phone,
					status: null
				};
				if(self.complaint_content == '') {
					mui.toast('请输入投诉内容');
					return;
				}
				$.ajax({
					type:"post",
					url:"http://172.10.10.130:8000/traffic/complaint/",
					async:true,
					dataType: "application/json",
					data: param,
					success: function(data) {
						console.log(data.results)
//						if(data.results) {
//							mui.toast(data.results.message);
//							self.complaint_content = '';
//						}
					},
					error: function(data) {
						self.complaint_content = '';
						mui.toast(JSON.parse(data.responseText).results.message)
					}
				});
//				fc.commonAjax('traffic/complaint/', param, 'POST').done(function(data) {
//					console.log(data.message)
//				})
			}
		}
	})
</script>